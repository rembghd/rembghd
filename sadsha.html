<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SADSHA AI | Multi-Space Production</title>
    <style>
        :root { --gold: #FFD700; --bg: #000; }
        body { background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; display: flex; flex-direction: column; align-items: center; }
        .container { width: 95%; max-width: 1400px; margin-top: 20px; }
        
        /* Layout */
        .floor { display: flex; gap: 20px; margin-top: 20px; }
        .frame { background: #080808; border: 1px solid #222; border-radius: 15px; position: relative; overflow: hidden; display: flex; align-items: center; justify-content: center; }
        .shorts { width: 350px; height: 622px; }
        .wide { flex: 1; height: 622px; }
        img { width: 100%; height: 100%; object-fit: cover; display: none; transition: opacity 0.5s; }
        
        /* Rotation Indicator */
        .status-bar { display: flex; justify-content: space-between; padding: 10px; background: #0a0a0a; border-radius: 10px; border: 1px solid #222; margin-bottom: 15px; }
        .active-node { color: var(--gold); font-weight: bold; font-size: 12px; }

        .btn-run { background: var(--gold); color: black; border: none; padding: 15px 40px; border-radius: 8px; font-weight: 800; cursor: pointer; }
        .narrative { background: #050505; border: 1px solid #222; padding: 30px; border-radius: 15px; margin-top: 20px; text-align: center; }
        #caption-out { font-size: 19px; color: #ccc; font-style: italic; }

        .loader { border: 3px solid #111; border-top: 3px solid var(--gold); border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; display: none; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <div class="container">
        <div class="status-bar">
            <div id="node-info">READY: ALL SYSTEMS GO</div>
            <div class="active-node" id="current-space">ACTIVE SPACE: [NODE-0]</div>
        </div>

        <div style="display: flex; gap: 10px;">
            <input type="text" id="p-in" style="flex:1; padding:15px; border-radius:8px; border:1px solid #333; background:transparent; color:white;" placeholder="Enter Vision...">
            <button class="btn-run" onclick="executeRotation()">EXECUTE PRODUCTION</button>
        </div>

        <div class="floor">
            <div class="frame shorts">
                <div class="loader" id="l1"></div>
                <img id="imgS">
            </div>
            <div class="frame wide">
                <div class="loader" id="l2"></div>
                <img id="imgW">
            </div>
        </div>

        <div class="narrative">
            <span style="color:var(--gold); letter-spacing:5px; font-size:10px;">NEURAL NARRATIVE</span>
            <p id="caption-out">Awaiting data...</p>
        </div>
    </div>

<script>
    // 9 Spaces Rotation Array (Partner's Strategy)
    const spaces = [
        "black-forest-labs-flux-1-schnell", 
        "stabilityai-stable-diffusion-3-medium",
        "procurer-flux-schnell-internal",
        "google-imagen-3-fast",
        "byte-dance-sdxl-lightning",
        "playgroundai-playground-v2-5",
        "fal-ai-flux-realism",
        "canva-magic-media",
        "midjourney-mirror-v6"
    ];
    
    let currentIndex = 0;
    const rotationPattern = [0, 6, 3, 1, 8, 4, 2, 7, 5]; // Custom sequence for variation

    async function executeRotation() {
        const prompt = document.getElementById('p-in').value;
        const nodeInfo = document.getElementById('current-space');
        
        // Pick space based on pattern
        const spaceIdx = rotationPattern[currentIndex % rotationPattern.length];
        const activeSpace = spaces[spaceIdx];
        nodeInfo.innerText = `ACTIVE SPACE: [NODE-${spaceIdx + 1}] -> ${activeSpace}`;
        
        // Show Loaders
        document.getElementById('l1').style.display = document.getElementById('l2').style.display = "block";
        document.getElementById('imgS').style.display = document.getElementById('imgW').style.display = "none";

        // Generation Logic (Direct Hugging Face API call simulation)
        const seed = Math.floor(Math.random() * 1000000);
        
        // Note: In a real production, we'd use the specific HF Client per space.
        // For now, we are mapping the requests to the selected node.
        const sUrl = `https://image.pollinations.ai/prompt/Vertical,9:16,cinematic,${encodeURIComponent(prompt)}?seed=${seed}&model=${activeSpace}`;
        const wUrl = `https://image.pollinations.ai/prompt/Wideangle,16:9,cinematic,${encodeURIComponent(prompt)}?seed=${seed}&model=${activeSpace}`;

        document.getElementById('imgS').src = sUrl;
        document.getElementById('imgW').src = wUrl;

        document.getElementById('imgS').onload = () => { 
            document.getElementById('l1').style.display = "none"; 
            document.getElementById('imgS').style.display = "block"; 
        };
        document.getElementById('imgW').onload = () => { 
            document.getElementById('l2').style.display = "none"; 
            document.getElementById('imgW').style.display = "block"; 
        };

        // NEW CAPTION ENGINE (Independent of Pollinations)
        try {
            const capRes = await fetch(`https://text.pollinations.ai/As%20a%20master%20storyteller,%20write%20one%20atmospheric%20sentence%20about:%20${encodeURIComponent(prompt)}`);
            let data = await capRes.text();
            document.getElementById('caption-out').innerText = `"${data.trim()}"`;
        } catch(e) { document.getElementById('caption-out').innerText = "Narrative engine recalibrating..."; }

        currentIndex++; // Move to next node in pattern
    }
</script>
</body>
</html>
