<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SadSha Lite | Free AI Engine</title>
    <style>
        body { background-color: #0f0f0f; color: white; font-family: 'Segoe UI', sans-serif; margin: 0; text-align: center; }
        .nav { padding: 15px; text-align: left; background: #1a1a1a; border-bottom: 1px solid #333; }
        .nav a { color: #FFD700; text-decoration: none; font-weight: bold; }
        
        .container { padding: 20px; max-width: 800px; margin: auto; }
        .header-box { background: #1a1a1a; padding: 20px; border-radius: 15px; margin-bottom: 20px; border: 1px solid #333; position: relative; }
        
        .input-group { position: relative; }
        input[type="text"] { width: 100%; padding: 15px; border-radius: 10px; border: 1px solid #444; background: #222; color: white; font-size: 16px; margin-bottom: 10px; box-sizing: border-box; }
        
        .enhance-btn { background: #8e44ad; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-size: 12px; margin-bottom: 15px; transition: 0.3s; }
        .enhance-btn:hover { background: #9b59b6; }

        .gen-btn { width: 100%; padding: 15px; background: #00ff88; color: black; border: none; border-radius: 10px; font-weight: bold; font-size: 18px; cursor: pointer; transition: 0.3s; }
        .gen-btn:active { transform: scale(0.98); }
        
        .stats { display: flex; justify-content: space-around; margin: 15px 0; font-size: 14px; color: #aaa; }
        .counter-val { color: #00ff88; font-weight: bold; }

        #result-display { margin-top: 20px; min-height: 400px; background: #111; border-radius: 15px; border: 1px solid #333; display: flex; align-items: center; justify-content: center; position: relative; overflow: hidden; }
        .result-img { max-width: 100%; display: none; border-radius: 10px; border: 1px solid #444; }
        .loader { display: none; color: #00ff88; font-weight: bold; animation: pulse 1.5s infinite; }
        
        @keyframes pulse { 0% { opacity: 0.5; } 50% { opacity: 1; } 100% { opacity: 0.5; } }
        
        .dl-btn { display: none; margin-top: 15px; background: #444; color: white; padding: 12px; border-radius: 8px; border: none; cursor: pointer; width: 100%; font-weight: bold; }
    </style>
</head>
<body>

<div class="nav">
    <a href="sadsha.html">← Back to Dashboard</a>
</div>

<div class="container">
    <div class="header-box">
        <h2>Lite Mode (Free)</h2>
        <div class="stats">
            <span>Daily Limit: <span class="counter-val" id="count-display">50/50</span></span>
            <span>Quality: <span style="color:white">Standard</span></span>
        </div>
        <div class="input-group">
            <input type="text" id="prompt-input" placeholder="What do you want to create?">
            <button class="enhance-btn" onclick="enhancePrompt()">✨ Auto Enhance Prompt</button>
        </div>
        <button id="main-gen-btn" class="gen-btn" onclick="generate()">Generate Masterpiece</button>
    </div>

    <div id="result-display">
        <div id="loader" class="loader">Mixing Pixels... Please wait...</div>
        <img id="output" class="result-img" src="">
    </div>
    <button id="dl-btn" class="dl-btn" onclick="download()">Download Image</button>
</div>

<script>
    // 1. URL se Prompt Lena (Transfer Logic)
    window.onload = function() {
        const urlParams = new URLSearchParams(window.location.search);
        const sharedPrompt = urlParams.get('p');
        if (sharedPrompt) {
            document.getElementById('prompt-input').value = decodeURIComponent(sharedPrompt);
        }
        updateCounterUI();
    };

    // 2. Counter Logic
    let freeLimit = localStorage.getItem('sadsha_free_limit') === null ? 50 : parseInt(localStorage.getItem('sadsha_free_limit'));

    function updateCounterUI() {
        document.getElementById('count-display').innerText = `${freeLimit}/50`;
        if (freeLimit <= 0) {
            document.getElementById('main-gen-btn').disabled = true;
            document.getElementById('main-gen-btn').style.background = "#555";
            document.getElementById('main-gen-btn').innerText = "Limit Reached!";
        }
    }

    // 3. Prompt Enhancer Logic
    function enhancePrompt() {
        const current = document.getElementById('prompt-input').value;
        if (!current) return alert("Kuch likhein toh sahi!");
        const adjectives = ["ultra-detailed", "cinematic lighting", "8k resolution", "masterpiece", "vibrant colors", "highly professional"];
        const randomAdj = adjectives[Math.floor(Math.random() * adjectives.length)] + ", " + adjectives[Math.floor(Math.random() * adjectives.length)];
        document.getElementById('prompt-input').value = `${current}, ${randomAdj}`;
    }

    // 4. Generate Logic
    async function generate() {
        const prompt = document.getElementById('prompt-input').value;
        if(!prompt) return alert("Write something first!");
        if(freeLimit <= 0) return alert("Daily limit khatam!");

        // Loader & UI update
        document.getElementById('loader').style.display = 'block';
        document.getElementById('output').style.display = 'none';
        document.getElementById('dl-btn').style.display = 'none';
        
        // Counter decrease
        freeLimit--;
        localStorage.setItem('sadsha_free_limit', freeLimit);
        updateCounterUI();

        // Pollinations URL
        const seed = Math.floor(Math.random() * 9999999);
        const url = `https://image.pollinations.ai/prompt/${encodeURIComponent(prompt)}?width=1024&height=1024&nologo=true&seed=${seed}`;
        
        const img = document.getElementById('output');
        img.src = url;
        
        img.onload = () => {
            document.getElementById('loader').style.display = 'none';
            img.style.display = 'block';
            document.getElementById('dl-btn').style.display = 'block';
            img.scrollIntoView({ behavior: 'smooth' });
        };
    }

    function download() {
        const a = document.createElement('a');
        a.href = document.getElementById('output').src;
        a.download = `SadSha_Lite_${Date.now()}.png`;
        a.click();
    }
</script>

</body>
</html>
